/* AIMS Mobile Overrides — SCRUM-240
   Only mobile/tablet behavior lives here. This file is loaded with media="(max-width: 991.98px)".
*/

/* ≤ 991.98px: tablet & phone — Filters drawer + medium stacks */
@media (max-width: 991.98px){
  /* Collapse inline filters, show toggle, and provide drawer */
  .filters-inline{ display: none !important; }
  .filters-toggle{ display: inline-flex !important; align-items: center; gap: .5rem; }

  .filters-drawer{
    position: fixed; inset: 0; background: rgba(0,0,0,.45); z-index: 1050;
    display: none;
  }
  .filters-drawer__panel{
    position: absolute; right: 0; top: 0; bottom: 0; width: min(92vw, 24rem);
    background: #fff; overflow-y: auto; padding: 1rem;
    box-shadow: -2px 0 12px rgba(0,0,0,.15);
  }
  .filters-drawer[aria-hidden="false"]{ display: block; }

  /* Medium stacks collapse vertically */
  .stack-md{ flex-direction: column !important; }
}

/* ≤ 767.98px: small tablets & large phones — Small stacks */
@media (max-width: 767.98px){
  .stack-sm{ flex-direction: column !important; }
}

/* ≤ 575.98px: phones — Modals fullscreen, action bars stack, reflow tables */
@media (max-width: 575.98px){
  /* Modals become fullscreen */
  .modal-dialog{
    width: 100vw; max-width: 100vw; margin: 0;
    height: 100%; display: flex; align-items: stretch;
  }
  .modal-content{
    height: 100%; border-radius: 0;
    display: flex; flex-direction: column;
  }
  .modal-header, .modal-footer{ padding: .75rem 1rem; }
  .modal-body{ padding: 1rem; overflow-y: auto; }

  /* Improve viewport height reliability on modern mobile browsers */
  @supports (height: 100dvh){
    .modal-dialog{ height: 100dvh; }
  }

  /* Action bars go vertical and full-width */
  .action-bar{ flex-direction: column !important; align-items: stretch !important; }
  .action-bar .btn, .action-bar button, .action-bar a[role="button"]{
    min-height: 44px; width: 100%;
  }

  /* Safer nav tap sizes */
  .nav-safe{ gap: .25rem; }
  .nav-safe a, .nav-safe button{ min-height: 44px; }

  /* Optional reflow pattern for dense tables */
  .table-reflow table, .table-reflow thead, .table-reflow tbody,
  .table-reflow th, .table-reflow td, .table-reflow tr{ display: block; }
  .table-reflow thead{ display: none; }
  .table-reflow tr{ margin-bottom: 1rem; border: 1px solid #e5e7eb; border-radius: .5rem; padding: .5rem; }
  .table-reflow td{
    display: grid; grid-template-columns: 10rem 1fr; gap: .5rem; padding: .25rem 0;
  }
  .table-reflow td::before{
    content: attr(data-label); font-weight: 600; opacity: .75;
  }

  /* Extra-small stacks collapse vertically */
  .stack-xs{ flex-direction: column !important; }
}

/* At phone width, custom-width modals should still fill the screen */
@media (max-width: 575.98px){
  .modal-dialog.custom-width,
  .modal-dialog.custom-width-two{
    width: 100vw; max-width: 100vw;
  }
}
/* --- Hardened mobile overrides to beat site.css if needed --- */

/* ≤ 991.98px: ensure drawer/toggle always switch correctly */
@media (max-width: 991.98px){
  .filters-inline{ display: none !important; }
  .filters-toggle{ display: inline-flex !important; align-items: center; gap: .5rem; }
  .filters-drawer[aria-hidden="false"]{ display: block !important; }
}

/* ≤ 575.98px: fullscreen modals with highest precedence */
@media (max-width: 575.98px){
  .modal-dialog{
    width: 100vw !important; max-width: 100vw !important; margin: 0 !important;
    height: 100% !important; display: flex !important; align-items: stretch !important;
  }
  .modal-content{
    height: 100% !important; border-radius: 0 !important;
    display: flex !important; flex-direction: column !important;
  }
  .modal-header, .modal-footer{ padding: .75rem 1rem !important; }
  .modal-body{ padding: 1rem !important; overflow-y: auto !important; }

  /* Fill screen even if custom width classes exist */
  .modal-dialog.custom-width,
  .modal-dialog.custom-width-two{
    width: 100vw !important; max-width: 100vw !important;
  }

  /* Action bar vertical, full-width buttons */
  .action-bar{ flex-direction: column !important; align-items: stretch !important; }
  .action-bar .btn, .action-bar button, .action-bar a[role="button"]{
    min-height: 44px !important; width: 100% !important;
  }

  /* Safer tap sizes on nav */
  .nav-safe{ gap: .25rem !important; }
  .nav-safe a, .nav-safe button{ min-height: 44px !important; }
}

/* Optional: dense table reflow always wins on phones */
@media (max-width: 575.98px){
  .table-reflow table, .table-reflow thead, .table-reflow tbody,
  .table-reflow th, .table-reflow td, .table-reflow tr{ display: block !important; }
  .table-reflow thead{ display: none !important; }
  .table-reflow tr{ margin-bottom: 1rem !important; border: 1px solid #e5e7eb !important; border-radius: .5rem !important; padding: .5rem !important; }
  .table-reflow td{
    display: grid !important; grid-template-columns: 10rem 1fr !important; gap: .5rem !important; padding: .25rem 0 !important;
  }
  .table-reflow td::before{
    content: attr(data-label); font-weight: 600; opacity: .75;
  }
}
